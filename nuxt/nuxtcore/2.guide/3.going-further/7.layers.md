---
title: Authoring Nuxt Layers
description: Nuxt provides a powerful system that allows you to extend the default files, configs, and much more.
---

Nuxt layers là một powerful feature mà bạn có thể use để share và reuse partial Nuxt applications within một monorepo, hoặc từ một git repository hoặc npm package. Layers structure almost identical đến một standard Nuxt application, which makes chúng easy để author và maintain.

:read-more{to="/docs/getting-started/layers"}

Một minimal Nuxt layer directory should contain một [`nuxt.config.ts`](/docs/guide/directory-structure/nuxt-config) file để indicate nó là một layer.

```ts [base/nuxt.config.ts]
export default defineNuxtConfig({})
```

Additionally, certain other files trong layer directory sẽ be auto-scanned và used bởi Nuxt cho project extending this layer.

- [`app/components/*`](/docs/guide/directory-structure/components)   - Extend default components
- [`app/composables/*`](/docs/guide/directory-structure/composables)  - Extend default composables
- [`app/layouts/*`](/docs/guide/directory-structure/layouts)  - Extend default layouts
- [`app/middleware/*`](/docs/guide/directory-structure/middleware)  - Extend default middleware
- [`app/pages/*`](/docs/guide/directory-structure/pages)        - Extend default pages
- [`app/plugins/*`](/docs/guide/directory-structure/plugins)        - Extend default plugins
- [`app/utils/*`](/docs/guide/directory-structure/utils)   - Extend default utils
- [`app/app.config.ts`](/docs/guide/directory-structure/app-config)  - Extend default app config
- [`server/*`](/docs/guide/directory-structure/server)       - Extend default server endpoints & middleware
- [`nuxt.config.ts`](/docs/guide/directory-structure/nuxt-config)- Extend default nuxt config

## Basic Example

::code-group

  ```ts [nuxt.config.ts]
  export default defineNuxtConfig({
    extends: [
      './base'
    ]
  })
  ```

  ```vue [app.vue]
    <template>
      <BaseComponent/>
    </template>
  ```

  ```ts [base/nuxt.config.ts]
    export default defineNuxtConfig({
      // Extending from base nuxt.config.ts!
      app: {
        head: {
          title: 'Extending Configs is Fun!',
          meta: [
            { name: 'description', content: 'I am using the extends feature in Nuxt!' }
          ],
        }
      }
    })
  ```

  ```vue [base/app/components/BaseComponent.vue]
    <template>
      <h1>Extending Components is Fun!</h1>
    </template>
  ```

::

## Starter Template

Để get started bạn có thể initialize một layer với [nuxt/starter/layer template](https://github.com/nuxt/starter/tree/layer). Điều này sẽ create một basic structure bạn có thể build upon. Execute command này within terminal để get started:

```bash [Terminal]
npm create nuxt -- --template layer nuxt-layer
```

Follow up trên README instructions cho next steps.

## Publishing Layers

Bạn có thể publish và share layers bằng either using một remote source hoặc một npm package.

### Git Repository

Bạn có thể use một git repository để share Nuxt layer của bạn. Some examples:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  extends: [
    'github:username/repoName',        // GitHub Remote Source
    'github:username/repoName/base',   // GitHub Remote Source within /base directory
    'github:username/repoName#dev',    // GitHub Remote Source from dev branch
    'github:username/repoName#v1.0.0', // GitHub Remote Source from v1.0.0 tag
    'gitlab:username/repoName',        // GitLab Remote Source example
    'bitbucket:username/repoName',     // Bitbucket Remote Source example
  ]
})
```

::tip
Nếu bạn want để extend một private remote source, bạn need để add environment variable `GIGET_AUTH=<token>` để provide một token.
::

::tip
Nếu bạn want để extend một remote source từ một self-hosted GitHub hoặc GitLab instance, bạn need để supply URL của nó với `GIGET_GITHUB_URL=<url>` hoặc `GIGET_GITLAB_URL=<url>` environment variable - hoặc directly configure nó với [the `auth` option](https://github.com/unjs/c12#extending-config-layer-from-remote-sources) trong `nuxt.config` của bạn.
::

::warning
Bear in mind rằng if bạn are extending một remote source như một layer, bạn will not be able để access dependencies của nó outside của Nuxt. For example, if remote layer depends trên một eslint plugin, điều này will not be usable trong eslint config của bạn. Đó là because những dependencies này will be located trong một special location (`node_modules/.c12/layer_name/node_modules/`) that is not accessible đến package manager của bạn.
::

::note
Khi using git remote sources, if một layer has npm dependencies và bạn wish để install chúng, bạn có thể do so bằng specifying `install: true` trong layer options của bạn.

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  extends: [
    ['github:username/repoName', { install: true }]
  ]
})
```
::

### npm Package

Bạn có thể publish Nuxt layers như một npm package that contains files và dependencies bạn want để extend. Điều này allows bạn để share config của bạn với others, use nó trong multiple projects hoặc use nó privately.

Để extend từ một npm package, bạn need để make sure rằng module published đến npm và installed trong user's project như một devDependency. Sau đó bạn có thể use module name để extend current nuxt config:

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  extends: [
    // Node Module with scope
    '@scope/moduleName',
    // or just the module name
    'moduleName'
  ]
})
```

Để publish một layer directory như một npm package, bạn want để make sure rằng `package.json` has correct properties filled out. Điều này will make sure rằng files are included khi package published.

```json [package.json]
{
  "name": "my-theme",
  "version": "1.0.0",
  "type": "module",
  "main": "./nuxt.config.ts",
  "dependencies": {},
  "devDependencies": {
    "nuxt": "^3.0.0"
  }
}
```

::important
Make sure bất kỳ dependency nào imported trong layer is **explicitly added** đến `dependencies`. `nuxt` dependency, và anything only used cho testing layer trước publishing, should remain trong `devDependencies` field.
::

Bây giờ bạn có thể proceed để publish module đến npm, either publicly hoặc privately.

::important
Khi publishing layer như một private npm package, bạn need để make sure bạn log in, để authenticate với npm để download node module.
::

## Tips

### Named Layer Aliases

Auto-scanned layers (từ `~~/layers` directory của bạn) automatically create aliases. For example, bạn có thể access `~~/layers/test` layer của bạn via `#layers/test`.

Nếu bạn want để create named layer aliases cho other layers, bạn có thể specify một name trong configuration của layer.

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  $meta: {
    name: 'example',
  },
})
```

Điều này will produce một alias của `#layers/example` which points đến layer của bạn.

### Relative Paths and Aliases

Khi importing using global aliases (such as `~/` và `@/`) trong một layer components và composables, note rằng những aliases này resolved relative đến user's project paths. As một workaround, bạn có thể **use relative paths** để import chúng, hoặc use named layer aliases.

Also khi using relative paths trong `nuxt.config` file của một layer, (with exception của nested `extends`) chúng resolved relative đến user's project instead của layer. As một workaround, use full resolved paths trong `nuxt.config`:

```js [nuxt.config.ts]
import { fileURLToPath } from 'url'
import { dirname, join } from 'path'

const currentDir = dirname(fileURLToPath(import.meta.url))

export default defineNuxtConfig({
  css: [
    join(currentDir, './app/assets/main.css')
  ]
})
```

## Multi-Layer Support for Nuxt Modules

Bạn có thể use internal array `nuxt.options._layers` để support custom multi-layer handling cho modules của bạn.

```ts [modules/my-module.ts]
export default defineNuxtModule({
  setup(_options, nuxt) {
    for (const layer of nuxt.options._layers) {
      // You can check for a custom directory existence to extend for each layer
      console.log('Custom extension for', layer.cwd, layer.config)
    }
  }
})
```

**Notes:**
- Earlier items trong `_layers` array have higher priority và override later ones
- User's project là first item trong `_layers` array

## Going Deeper

Configuration loading và extends support handled bởi [unjs/c12](https://github.com/unjs/c12), merged using [unjs/defu](https://github.com/unjs/defu) và remote git sources supported using [unjs/giget](https://github.com/unjs/giget). Check docs và source code để learn more.

::read-more{icon="i-simple-icons-github" to="https://github.com/nuxt/nuxt/issues/13367" target="_blank"}
Checkout ongoing development của chúng tôi để bring more improvements cho layers support trên GitHub.
::
