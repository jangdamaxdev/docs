---
title: 'Error Handling'
description: 'Learn how to catch and handle errors in Nuxt.'
navigation.icon: i-lucide-bug-off
---

Nuxt là một full-stack framework, điều này có nghĩa là có một số nguồn lỗi runtime của người dùng không thể tránh khỏi có thể xảy ra ở các ngữ cảnh khác nhau:

- Errors during the Vue rendering lifecycle (SSR & CSR)
- Server and client startup errors (SSR + CSR)
- Errors during Nitro server lifecycle ([`server/`](/docs/guide/directory-structure/server) directory)
- Errors downloading JS chunks

::tip
**SSR** là viết tắt của **Server-Side Rendering** và **CSR** là **Client-Side Rendering**.
::

## Vue Errors

Bạn có thể bắt lỗi Vue bằng cách sử dụng [`onErrorCaptured`](https://vuejs.org/api/composition-api-lifecycle.html#onerrorcaptured).

Ngoài ra, Nuxt cung cấp hook [`vue:error`](/docs/api/advanced/hooks#app-hooks-runtime) sẽ được gọi nếu bất kỳ lỗi nào lan truyền lên cấp cao nhất.

Nếu bạn đang sử dụng một framework báo cáo lỗi, bạn có thể cung cấp một global handler thông qua [`vueApp.config.errorHandler`](https://vuejs.org/api/application.html#app-config-errorhandler). Nó sẽ nhận tất cả lỗi Vue, ngay cả khi những lỗi đó đã được xử lý.

```ts twoslash [plugins/error-handler.ts]
export default defineNuxtPlugin((nuxtApp) => {
  nuxtApp.vueApp.config.errorHandler = (error, instance, info) => {
    // handle error, e.g. report to a service
  }

  // Also possible
  nuxtApp.hook('vue:error', (error, instance, info) => {
    // handle error, e.g. report to a service
  })
})
```

::note
Lưu ý rằng hook `vue:error` dựa trên lifecycle hook [`onErrorCaptured`](https://vuejs.org/api/composition-api-lifecycle.html#onerrorcaptured).
::

## Startup Errors

Nuxt sẽ gọi hook `app:error` nếu có bất kỳ lỗi nào khi khởi động ứng dụng Nuxt của bạn.

Điều này bao gồm:
- running [Nuxt plugins](/docs/guide/directory-structure/plugins)
- processing `app:created` and `app:beforeMount` hooks
- rendering your Vue app to HTML (during SSR)
- mounting the app (on client-side), though you should handle this case with `onErrorCaptured` or with `vue:error`
- processing the `app:mounted` hook

## Nitro Server Errors

Bạn hiện không thể định nghĩa một server-side handler cho những lỗi này, nhưng có thể render một trang lỗi — xem mục [Render an Error Page](#error-page).

## Errors with JS Chunks

Bạn có thể gặp lỗi tải chunk do sự cố kết nối mạng hoặc do một lần triển khai mới (làm cho các URL JS chunk cũ có hash bị vô hiệu). Nuxt cung cấp hỗ trợ sẵn để xử lý lỗi tải chunk bằng cách thực hiện reload cứng khi một chunk không thể tải trong quá trình điều hướng route.

Bạn có thể thay đổi hành vi này bằng cách đặt `experimental.emitRouteChunkError` thành `false` (để vô hiệu hóa hoàn toàn việc hook vào các lỗi này) hoặc thành `manual` nếu bạn muốn tự xử lý. Nếu bạn muốn xử lý lỗi tải chunk thủ công, bạn có thể tham khảo [the automatic implementation](https://github.com/nuxt/nuxt/blob/main/packages/nuxt/src/app/plugins/chunk-reload.client.ts) để lấy ý tưởng.

## Error Page

::note
Khi Nuxt gặp lỗi nghiêm trọng (bất kỳ lỗi nào không được xử lý trên server, hoặc một lỗi được tạo với `fatal: true` trên client) nó sẽ hoặc render phản hồi JSON (nếu được yêu cầu với header `Accept: application/json`) hoặc hiển thị một trang lỗi toàn màn hình.
::

Một lỗi có thể xảy ra trong vòng đời server khi:
- processing your Nuxt plugins
- rendering your Vue app into HTML
- a server API route throws an error

Nó cũng có thể xảy ra ở phía client khi:
- processing your Nuxt plugins
- before mounting the application (`app:beforeMount` hook)
- mounting your app if the error was not handled with `onErrorCaptured` or `vue:error` hook
- the Vue app is initialized and mounted in browser (`app:mounted`).

::read-more{to="/docs/api/advanced/hooks"}
Khám phá tất cả lifecycle hook của Nuxt.
::

Tùy chỉnh trang lỗi mặc định bằng cách thêm `~/error.vue` vào thư mục source của ứng dụng, cùng cấp với `app.vue`.

```vue [error.vue]
<script setup lang="ts">
import type { NuxtError } from '#app'

const props = defineProps({
  error: Object as () => NuxtError
})

const handleError = () => clearError({ redirect: '/' })
</script>

<template>
  <div>
    <h2>{{ error?.statusCode }}</h2>
    <button @click="handleError">Clear errors</button>
  </div>
</template>
```

::read-more{to="/docs/guide/directory-structure/error"}
Đọc thêm về `error.vue` và cách sử dụng.
::

Với các lỗi tuỳ chỉnh, chúng tôi rất khuyến nghị sử dụng composable `onErrorCaptured` — có thể gọi trong hàm setup của page/component — hoặc hook runtime `vue:error` có thể cấu hình trong một Nuxt plugin.

```ts twoslash [plugins/error-handler.ts]
export default defineNuxtPlugin(nuxtApp => {
  nuxtApp.hook('vue:error', (err) => {
    //
  })
})
```

Khi bạn muốn loại bỏ trang lỗi, bạn có thể gọi helper [`clearError`](/docs/api/utils/clear-error), helper này nhận một path tuỳ chọn để redirect (ví dụ, nếu bạn muốn điều hướng đến một trang "an toàn").

::important
Hãy chắc chắn kiểm tra trước khi sử dụng bất kỳ thứ gì phụ thuộc vào Nuxt plugins, chẳng hạn như `$route` hoặc `useRouter`, bởi vì nếu một plugin ném lỗi, nó sẽ không được chạy lại cho đến khi bạn xoá lỗi.
::

::note
Render một trang lỗi là một lần load trang hoàn toàn riêng biệt, có nghĩa là mọi middleware đã đăng ký sẽ chạy lại. Bạn có thể sử dụng [`useError`](#useerror) trong middleware để kiểm tra xem có lỗi đang được xử lý hay không.
::

::note
Nếu bạn đang chạy trên Node 16 và bạn set bất kỳ cookie nào khi render trang lỗi, chúng sẽ [ghi đè cookie đã set trước đó](https://github.com/nuxt/nuxt/pull/20585). Chúng tôi khuyến nghị sử dụng phiên bản Node mới hơn vì Node 16 đã hết vòng đời vào tháng 9 năm 2023.
::

## Error Utils

### `useError`

```ts [TS Signature]
function useError (): Ref<Error | { url, statusCode, statusMessage, message, description, data }>
```

Hàm này sẽ trả về lỗi Nuxt toàn cục đang được xử lý.

::read-more{to="/docs/api/composables/use-error"}
Đọc thêm về composable `useError`.
::

### `createError`

```ts [TS Signature]
function createError (err: string | { cause, data, message, name, stack, statusCode, statusMessage, fatal }): Error
```

Tạo một đối tượng lỗi với metadata bổ sung. Bạn có thể truyền một chuỗi để đặt `message` của lỗi hoặc một object chứa các thuộc tính lỗi. Hàm này có thể sử dụng được cả ở phần Vue và phần Server của ứng dụng của bạn, và được thiết kế để được `throw`.

Nếu bạn `throw` một lỗi được tạo bằng `createError`:
- on server-side, it will trigger a full-screen error page which you can clear with [`clearError`](#clearerror).
- on client-side, it will throw a non-fatal error for you to handle. If you need to trigger a full-screen error page, then you can do this by setting `fatal: true`.

```vue twoslash [pages/movies/[slug\\].vue]
<script setup lang="ts">
const route = useRoute()
const { data } = await useFetch(`/api/movies/${route.params.slug}`)

if (!data.value) {
  throw createError({
    statusCode: 404,
    statusMessage: 'Page Not Found'
  })
}
</script>
```

::read-more{to="/docs/api/utils/create-error"}
Đọc thêm về tiện ích `createError`.
::

### `showError`

```ts [TS Signature]
function showError (err: string | Error | { statusCode, statusMessage }): Error
```

Bạn có thể gọi hàm này ở bất kỳ điểm nào phía client, hoặc (ở phía server) trực tiếp trong middleware, plugin hoặc hàm `setup()`. Hàm này sẽ kích hoạt trang lỗi toàn màn hình mà bạn có thể xoá bằng [`clearError`](#clearerror).

Chúng tôi khuyến nghị sử dụng `throw createError()` thay cho `showError` khi có thể.

::read-more{to="/docs/api/utils/show-error"}
Đọc thêm về tiện ích `showError`.
::

### `clearError`

```ts [TS Signature]
function clearError (options?: { redirect?: string }): Promise<void>
```

Hàm này sẽ xoá lỗi Nuxt hiện tại đang được xử lý. Nó cũng nhận một path tuỳ chọn để redirect (ví dụ, điều hướng đến một trang "an toàn").

::read-more{to="/docs/api/utils/clear-error"}
Đọc thêm về tiện ích `clearError`.
::

## Render Error in Component

Nuxt cũng cung cấp component [`<NuxtErrorBoundary>`](/docs/api/components/nuxt-error-boundary) cho phép bạn xử lý lỗi phía client trong ứng dụng của mình, mà không cần thay thế toàn bộ site bằng một trang lỗi.

Component này chịu trách nhiệm xử lý lỗi xảy ra trong default slot của nó. Ở phía client, nó sẽ ngăn lỗi lan truyền lên cấp cao nhất và sẽ render slot `#error` thay thế.

Slot `#error` sẽ nhận `error` như một prop. (Nếu bạn đặt `error = null` thì nó sẽ kích hoạt render lại default slot; bạn cần đảm bảo lỗi đã thực sự được giải quyết trước, nếu không slot lỗi sẽ chỉ được render lại lần nữa.)

::tip
Nếu bạn điều hướng sang một route khác, lỗi sẽ tự động được xoá.
::

```vue [pages/index.vue]
<template>
  <!-- some content -->
  <NuxtErrorBoundary @error="someErrorLogger">
    <!-- You use the default slot to render your content -->
    <template #error="{ error, clearError }">
      You can display the error locally here: {{ error }}
      <button @click="clearError">
        This will clear the error.
      </button>
    </template>
  </NuxtErrorBoundary>
</template>
```

:link-example{to="/docs/examples/advanced/error-handling"}
